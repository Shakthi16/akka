<html>
<head>
    <title>Happy Birthday Sister</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css?family=Lato:300italic');

        .fade-in {
            animation: fadeIn 3s ease-in-out;
        }

        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        .cake {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto;
            cursor: pointer;
        }

        .velas {
            background: rgba(255, 182, 193, 1);
            border-radius: 100%;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -33.33px;
            width: 10px;
            height: 33.33px;
        }

        .velas:after,
        .velas:before {
            background: rgba(255, 105, 180, 0.4);
            content: "";
            position: absolute;
            width: 100%;
            height: 4.44px;
        }

        .velas:after {
            top: 25%;
            left: 0;
        }

        .velas:before {
            top: 45%;
            left: 0;
        }

        .fuego {
            border-radius: 100%;
            box-shadow: 0 0 40px 10px rgba(248, 233, 209, 0.2);
            position: absolute;
            top: -12px;
            left: 50%;
            margin-left: -6.67px;
            width: 13.33px;
            height: 25px;
        }

        .fuego:nth-child(1) {
            animation: fuego 2s infinite;
        }

        .fuego:nth-child(2) {
            animation: fuego 1.5s infinite;
        }

        .fuego:nth-child(3) {
            animation: fuego 1s infinite;
        }

        .fuego:nth-child(4) {
            animation: fuego 0.5s infinite;
        }

        .fuego:nth-child(5) {
            animation: fuego 0.2s infinite;
        }

        @keyframes fuego {
            0% {
                background: rgba(254, 248, 97, 0.5);
                transform: translateY(0) scale(1);
            }
            50% {
                background: rgba(255, 50, 0, 0.1);
                transform: translateY(-40px) scale(0);
            }
            100% {
                background: rgba(254, 248, 97, 0.5);
                transform: translateY(0) scale(1);
            }
        }

        .cobertura {
            background: rgba(255, 182, 193, 1);
            border-radius: 100px;
            position: absolute;
            top: 60%;
            left: 50%;
            margin-left: -55.56px;
            margin-top: -20px;
            width: 111.11px;
            height: 25px;
            z-index: 10;
        }

        .cobertura:after,
        .cobertura:before {
            background: rgba(255, 182, 193, 1);
            border-radius: 100px;
            content: "";
            position: absolute;
            width: 10px;
            height: 20px;
        }

        .cobertura:after {
            top: 13.33px;
            right: 28.57px;
        }

        .cobertura:before {
            top: 20px;
            right: 18.18px;
        }

        .bizcocho {
            background: rgba(255, 105, 180, 1);
            position: absolute;
            bottom: 0;
            left: 50%;
            margin-left: -50px;
            width: 100px;
            height: 66.67px;
        }

        .bizcocho:after,
        .bizcocho:before {
            background: rgba(255, 182, 193, 0.6);
            content: "";
            position: absolute;
            width: 100%;
            height: 5px;
        }

        .bizcocho:after {
            top: 20px;
            left: 0;
        }

        .bizcocho:before {
            top: 40px;
            left: 0;
        }

        h1,
        p {
            font-family: 'Lato', sans-serif;
            font-weight: 300;
            font-style: italic;
            text-align: center;
            width: 100%;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        h1 {
            color: rgba(108, 82, 153, 1);
            font-size: 1em;
            margin-top: 136px;
        }

        p {
            color: rgba(236, 231, 227, 0.6);
            font-size: 0.8em;
            line-height: 2em;
        }

        .cake {
            cursor: pointer;
        }

        .cake .fuego {
            display: block;
        }

        .cake.off .fuego {
            display: none;
        }

        .paper {
            display: none;
            position: relative;
            width: 90%;
            max-width: 300px;
            height: auto;
            margin: 20px auto;
            background: #fff;
            border: 2px solid #ccc;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            transform: scaleY(0);
            transform-origin: top;
            transition: transform 0.5s ease-in-out;
        }

        .paper.open {
            display: block;
            transform: scaleY(1);
        }

        .fireworks {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #020202;
            cursor: crosshair;
        }

        .fireworks.open {
            display: block;
        }

        .fireworks h1 {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-family: "Source Sans Pro";
            font-size: 1.5em;
            font-weight: 900;
            -webkit-user-select: none;
            user-select: none;
            text-align: center;
        }

        canvas {
            display: block;
        }

        .heart-container {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .arrow {
            position: absolute;
            left: -50px;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(-10px);
            }
        }
    </style>
</head>
<body class="bg-pink-100 flex items-center justify-center min-h-screen">
    <div class="text-center fade-in">
        <div class="cake" onclick="blowCandles()">
            <div class="velas">
                <div class="fuego"></div>
                <div class="fuego"></div>
                <div class="fuego"></div>
                <div class="fuego"></div>
                <div class="fuego"></div>
            </div>
            <div class="cobertura"></div>
            <div class="bizcocho"></div>
            <h1>Happy Birthday!</h1>
            <p style="color:blue">Akka</p>
        </div>
        <p class="text-lg font-roboto text-gray-700 mt-4" id="wish-text">Pray for a wish and touch the candle to blow it out!</p>
    </div>

    <div class="paper" id="paper">
        <div class="letter" id="letter">
            <h1 class="text-4xl font-pacifico text-pink-600 mb-4">Happy Birthday Sister!</h1>
            <p class="text-lg font-roboto text-gray-700 mb-4">
                I am so blessed to have you in my life. I miss you so much and I will always pray for you to be happy and happy alone.
            </p>
            <p class="text-lg font-roboto text-gray-700">With all my love,</p>
            <p class="text-lg font-roboto text-gray-700">Your loving sibling</p>
            <div class="heart-container mt-6">
                <i class="fas fa-heart text-pink-500 text-3xl" onclick="showFireworks()"></i>
                <div class="arrow">
                    <i class="fas fa-arrow-right text-pink-500 text-2xl"></i>
                </div>
            </div>
            <p class="text-lg font-roboto text-gray-700 mt-4">Touch the heart after praying for something!</p>
        </div>
    </div>

    <div class="fireworks" id="fireworks">
        <h1>Everything happens as you wish. Happy Happy Birthday Akka!</h1>
        <canvas id="birthday"></canvas>
    </div>

    <script>
        function blowCandles() {
            document.querySelector('.cake').style.display = 'none';
            document.getElementById('wish-text').style.display = 'none';
            setTimeout(() => {
                document.getElementById('paper').classList.add('open');
                document.getElementById('letter').classList.add('open');
            }, 500);
        }

        function showFireworks() {
            document.getElementById('paper').style.display = 'none';
            document.getElementById('fireworks').classList.add('open');
            startFireworks();
        }

        function startFireworks() {
            const PI2 = Math.PI * 2;
            const random = (min, max) => Math.random() * (max - min + 1) + min | 0;
            const timestamp = _ => new Date().getTime();

            class Birthday {
                constructor() {
                    this.resize();
                    this.fireworks = [];
                    this.counter = 0;
                }

                resize() {
                    this.width = canvas.width = window.innerWidth;
                    let center = this.width / 2 | 0;
                    this.spawnA = center - center / 4 | 0;
                    this.spawnB = center + center / 4 | 0;
                    this.height = canvas.height = window.innerHeight;
                    this.spawnC = this.height * .1;
                    this.spawnD = this.height * .5;
                }

                onClick(evt) {
                    let x = evt.clientX || evt.touches && evt.touches[0].pageX;
                    let y = evt.clientY || evt.touches[0].pageY;
                    let count = random(3, 5);
                    for (let i = 0; i < count; i++) this.fireworks.push(new Firework(
                        random(this.spawnA, this.spawnB),
                        this.height,
                        x,
                        y,
                        random(0, 260),
                        random(30, 110)));
                    this.counter = -1;
                }

                update(delta) {
                    ctx.globalCompositeOperation = 'hard-light';
                    ctx.fillStyle = `rgba(20,20,20,${ 7 * delta })`;
                    ctx.fillRect(0, 0, this.width, this.height);
                    ctx.globalCompositeOperation = 'lighter';
                    for (let firework of this.fireworks) firework.update(delta);
                    this.counter += delta * 3;
                    if (this.counter >= 1) {
                        this.fireworks.push(new Firework(
                            random(this.spawnA, this.spawnB),
                            this.height,
                            random(0, this.width),
                            random(this.spawnC, this.spawnD),
                            random(0, 360),
                            random(30, 110)));
                        this.counter = 0;
                    }
                    if (this.fireworks.length > 1000) this.fireworks = this.fireworks.filter(firework => !firework.dead);
                }
            }

            class Firework {
                constructor(x, y, targetX, targetY, shade, offsprings) {
                    this.dead = false;
                    this.offsprings = offsprings;
                    this.x = x;
                    this.y = y;
                    this.targetX = targetX;
                    this.targetY = targetY;
                    this.shade = shade;
                    this.history = [];
                }

                update(delta) {
                    if (this.dead) return;
                    let xDiff = this.targetX - this.x;
                    let yDiff = this.targetY - this.y;
                    if (Math.abs(xDiff) > 3 || Math.abs(yDiff) > 3) {
                        this.x += xDiff * 2 * delta;
                        this.y += yDiff * 2 * delta;
                        this.history.push({ x: this.x, y: this.y });
                        if (this.history.length > 20) this.history.shift();
                    } else {
                        if (this.offsprings && !this.madeChilds) {
                            let babies = this.offsprings / 2;
                            for (let i = 0; i < babies; i++) {
                                let targetX = this.x + this.offsprings * Math.cos(PI2 * i / babies) | 0;
                                let targetY = this.y + this.offsprings * Math.sin(PI2 * i / babies) | 0;
                                birthday.fireworks.push(new Firework(this.x, this.y, targetX, targetY, this.shade, 0));
                            }
                        }
                        this.madeChilds = true;
                        this.history.shift();
                    }
                    if (this.history.length === 0) this.dead = true;
                    else if (this.offsprings) {
                        for (let i = 0; this.history.length > i; i++) {
                            let point = this.history[i];
                            ctx.beginPath();
                            ctx.fillStyle = 'hsl(' + this.shade + ',100%,' + i + '%)';
                            ctx.arc(point.x, point.y, 1, 0, PI2, false);
                            ctx.fill();
                        }
                    } else {
                        ctx.beginPath();
                        ctx.fillStyle = 'hsl(' + this.shade + ',100%,50%)';
                        ctx.arc(this.x, this.y, 1, 0, PI2, false);
                        ctx.fill();
                    }
                }
            }

            let canvas = document.getElementById('birthday');
            let ctx = canvas.getContext('2d');
            let then = timestamp();
            let birthday = new Birthday();
            window.onresize = () => birthday.resize();
            document.onclick = evt => birthday.onClick(evt);
            document.ontouchstart = evt => birthday.onClick(evt);

            (function loop() {
                requestAnimationFrame(loop);
                let now = timestamp();
                let delta = now - then;
                then = now;
                birthday.update(delta / 1000);
            })();
        }
    </script>
</body>
</html>
